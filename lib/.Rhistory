packages.used))
packages.used=c("gbm", "caret","DMwR" ,"nnet","randomForest","EBImage","e1071")
packages.needed=setdiff(packages.used,
intersect(installed.packages()[,1],
packages.used))
if(length(packages.needed)>0){
install.packages(packages.needed, dependencies = TRUE)
}
source("http://bioconductor.org/biocLite.R")
biocLite("EBImage")
packages.used=c("gbm", "caret","DMwR" ,"nnet","randomForest","EBImage","e1071")
packages.needed=setdiff(packages.used,
intersect(installed.packages()[,1],
packages.used))
install.packages("e1071", type ="source")
setwd("~/")
read.csv("lbp_feature.csv")
a = read.csv("lbp_feature.csv")
a = read.csv("lbp_feature.csv")
a
a = read.table("sampleList.txt")
View(a)
a = read.table("lbp_feature.txt")
a
a = read.table("lbp_feature.txt")
a = read.table("lbp_feature.txt")
train<-function(X, y, depth, shrinkage){
library('gbm')
fit_gbm = gbm.fit(X, y,
distribution = "multinomial",
n.trees = 250,
interaction.depth = depth,
shrinkage = shrinkage,
bag.fraction = 0.5,
verbose=FALSE)
best_iter <- gbm.perf(fit_gbm, method="OOB", plot.it = FALSE)
return(list(fit=fit_gbm, iter=best_iter))
}
test = function(fit_train, dat_test){
library("gbm")
pred <- predict(fit_train$fit, newdata = dat_test,
n.trees = fit_train$iter,
type="response")
return(as.numeric(pred> 0.5))
}
cv.function<-function(X, y, depth, shrinkage, K=5){
n = length(y)
n.fold = floor(n/K)
s = sample(rep(1:K, c(rep(n.fold, K-1), n-(K-1)*n.fold)))
cv.error = rep(NA, K)
for (i in 1:K){
train.data = X[s != i,]
train.label = y[s != i]
test.data = X[s == i,]
test.label = y[s == i]
fit = train(train.data, train.label, depth, shrinkage)
pred = test(fit, test.data)
cv.error[i] = mean(pred != test.label)
}
return(c(mean(cv.error),sd(cv.error)))
}
depths = c(3, 5, 7, 9, 11)
shrinkages = 0.1
err_cv = array(dim=c(length(depths),2))
library("EBImage")
library("gbm")
library("caret")
library("DMwR")
library("nnet")
library("randomForest")
library("e1071")
setwd("/Users/sijian/Documents/Github/Fall2017-project3-fall2017-project3-grp6/doc")
sift.feature=read.csv("../data/sift_feature.csv", header = T)
lbp.feature=read.csv("../data/lbp_feature.csv", header = F)
hog.feature = read.csv("../data/hog_feature.csv")
label=read.csv("../data/trainlabel.csv")
source("../lib/tune gbm.r")
sift_data=data.frame(cbind(label,sift.feature[,-1]))
test.index=sample(1:2000,400,replace=F)
colnames(sift_data)[2]="y"
sift_data = sift_data[,-1]
test.sift=sift_data[test.index,]
test.x.sift=test.sift[,-1]
train.sift=sift_data[-test.index,]
source("../lib/tune gbm.r")
sift_data=data.frame(cbind(label,sift.feature[,-1]))
test.index=sample(1:2000,400,replace=F)
colnames(sift_data)[2]="y"
sift_data = sift_data[,-1]
test.sift=sift_data[test.index,]
test.x.sift=test.sift[,-1]
train.sift=sift_data[-test.index,]
for(k in 1:length(depths)){
cat("k=", k, "\n")
err_cv[k,] <- cv.function(X, y, depths[k], shrinkage=shrinkages, K=5)  #K=5
}
View(err_cv)
err_cv
source("../lib/train.r")
source("../lib/test.r")
colnames(err_cv) = c("mean of cv.error","sd of cv.error")
rownames(err_cv) = c("depth = 3", "depth = 5", "depth = 7", "depth = 9","depth = 11")
err_cv
if(!require("EBImage")){
source("https://bioconductor.org/biocLite.R")
biocLite("EBImage")
}
packages.used=c("gbm", "caret","DMwR" ,"nnet","randomForest","e1071")
packages.needed=setdiff(packages.used,
intersect(installed.packages()[,1],
packages.used))
if(length(packages.needed)>0){
install.packages(packages.needed, dependencies = TRUE)
}
library("EBImage")
library("gbm")
library("caret")
library("DMwR")
library("nnet")
library("randomForest")
library("e1071")
setwd("/Users/sijian/Documents/Github/Fall2017-project3-fall2017-project3-grp6/doc")
# here replace it with your own path or manually set it in RStudio to where this rmd file is located.
sift.feature=read.csv("../data/sift_feature.csv", header = T)
sift.feature=read.csv("../data/sift_feature.csv", header = T)
sift.feature=read.csv("../data/sift_feature.csv", header = T)
lbp.feature=read.csv("../data/lbp_feature.csv", header = F)
hog.feature = read.csv("../data/hog_feature.csv")
label=read.csv("../data/trainlabel.csv")
source("../lib/tune gbm.r")
sift_data=data.frame(cbind(label,sift.feature[,-1]))
test.index=sample(1:2000,400,replace=F)
colnames(sift_data)[2]="y"
sift_data = sift_data[,-1]
test.sift=sift_data[test.index,]
test.x.sift=test.sift[,-1]
train.sift=sift_data[-test.index,]
write.csv(err_cv,file = "err_cv_for_baseline.csv")
View(err_cv)
test.index=sample(1:3000,400,replace=F)
test.index=sample(1:3000,500,replace=F)
test.sift=sift_data[test.index,]
test.x.sift=test.sift[,-1]
train.sift=sift_data[-test.index,]
lbpdata = data.frame(cbind(label,lbp.feature))
colnames(lbpdata)
colnames(lbpdata)[2] = "y"
sift_data=data.frame(cbind(label,sift.feature[,-1]))
test.index=sample(1:3000,500,replace=F)
colnames(sift_data)[2]="y"
sift_data = sift_data[,-1]
test.sift=sift_data[test.index,]
test.x.sift=test.sift[,-1]
train.sift=sift_data[-test.index,]
lbptest = lbpdata[test.index]
lbptest = lbpdata[test.index,]
lbpdata = data.frame(cbind(label,lbp.feature))
colnames(lbpdata)[2] = "y"
lbpdata = data.frame(cbind(label,lbp.feature))
colnames(lbpdata)[2] = "y"
test.lbp = lbpdata[test.index,]
View(test.lbp)
test.x.lbp = test.lbp[,-c(1,2)]
View(test.x.lbp)
train.lbp = lbpdata[-test.index,]
View(train.lbp)
lbpdata = data.frame(cbind(label,lbp.feature))
colnames(lbpdata)[2] = "y"
lbpdata = lbpdata[,-1]
lbpdata = data.frame(cbind(label,lbp.feature))
colnames(lbpdata)[2] = "y"
lbpdata = lbpdata[,-1]
test.lbp = lbpdata[test.index,]
test.x.lbp = test.lbp[,-1]
train.lbp = lbpdata[-test.index,]
View(train.lbp)
View(test.lbp)
source("../lib/train.r")
source("../lib/test.r")
gbm_model = train.baseline(train.lbp)
gbm.prediction = test.baseline(gbm_model,test.x.lbp)
gbm_model = train.baseline(train.lbp)
gbm_model = train.baseline(train.lbp)
source("../lib/train.r")
gbm_model = train.baseline(train.lbp)
?gbm.fit
gbm_model = train.baseline(train.lbp)
source("../lib/train.r")
gbm_model = train.baseline(train.lbp)
View(train.lbp)
source("../lib/train.r")
gbm_model = train.baseline(train.lbp)
source("../lib/train.r")
source("../lib/test.r")
View(test.x.lbp)
View(train.lbp)
source("../lib/train.r")
gbm_model = train.baseline(train.lbp)
source("../lib/train.r")
gbm_model = train.baseline(train.lbp)
?gbm.fit
source("../lib/train.r")
gbm_model = train.baseline(train.lbp)
View(train.lbp)
X = train.lbp[,-1]
y = train.lbp[,1]
gbm_model = train.baseline(train.lbp)
source("../lib/train.r")
X = train.lbp[,-1]
y = train.lbp[,1]
gbm_model = train.baseline(train.lbp)
gbm_model = train.baseline(X,y)
X = train.lbp[,-1]
y = train.lbp[,1]
source("../lib/tune gbm.r")
X = train.lbp[,-1]
y = train.lbp[,1]
source("../lib/tune gbm.r")
for(k in 1:length(depths)){
cat("k=", k, "\n")
err_cv[k,] <- cv.function(X, y, depths[k], shrinkage=shrinkages, K=5)  #K=5
}
View(err_cv)
colnames(err_cv) = c("mean of cv.error","sd of cv.error")
rownames(err_cv) = c("depth = 3", "depth = 5", "depth = 7", "depth = 9","depth = 11")
print(err_cv)
write.csv(err_cv,file = "err_cv_for_GBM+LBP.csv")
bp.model=train.bp(train)
bp.model=train.bp(train.lbp)
bp.pre=test.bp(bp.model,test.x.lbp)
table(bp.pre,test.lbp$y)
bp.model=train.bp(train.lbp)
bp.pre=test.bp(bp.model,test.x.lbp)
rf.model <- train.rf(train)
table(rf.pre,test$y)
rf.model <- train.rf(train.lbp)
rf.model <- train.rf(train.lbp)
rf.pre=test.rf(rf.model,test.x.lbp)
table(rf.pre,test.lbp$y)
svm.model <- train.svm(train)
svm.pre=test.svm(svm.model,test.x)
table(svm.pre,test$y)
svm.model <- train.svm(train.lbp)
svm.model <- train.svm(train.lbp)
svm.pre=test.svm(svm.model,test.x.lbp)
svm.pre=test.svm(svm.model,test.x.lbp)
table(svm.pre,test.lbp$y)
svm.model <- train.svm(train.lbp)
svm.model <- train.svm(train.lbp)
svm.pre=test.svm(svm.model,test.x.lbp)
svm.pre=test.svm(svm.model,test.x.lbp)
table(svm.pre,test.lbp$y)
log.model <- train.log(train.lbp)
table(log.pre, test.lbp$y)
log.model <- train.log(train.lbp)
source("../lib/train.r")
source("../lib/test.r")
log.model <- train.log(train.lbp)
source("../lib/train.r")
source("../lib/test.r")
log.model <- train.log(train.lbp)
log.pre=test.log(log.model, test.x.lbp)
table(log.pre, test.lbp$y)
log.model <- train.log(train.lbp)
log.pre=test.log(log.model, test.x.lbp)
install.packages("knitr")
library("knitr")
devtools::install_github("rstudio/rmarkdown")
knit_with_parameters('~/Documents/GitHub/Fall2017-project3-fall2017-project3-grp6/doc/main.Rmd')
H <return>
#Install necessary packages.
```{r,message=F, warning=F}
load("/Users/sijian/Documents/GitHub/fall2017-project4-fall2017-proj4-grp8/output/movie.test.Rdata")
load("/Users/sijian/Documents/GitHub/fall2017-project4-fall2017-proj4-grp8/output/movie.train.Rdata")
load("/Users/sijian/Documents/GitHub/fall2017-project4-fall2017-proj4-grp8/output/web.test.Rdata")
load("/Users/sijian/Documents/GitHub/fall2017-project4-fall2017-proj4-grp8/output/web.train.Rdata")
load("/Users/sijian/Documents/GitHub/fall2017-project4-fall2017-proj4-grp8/output/eachmovie.matrix.Rdata")
webtrain_a = read.csv("../output/webtrain_a.csv", header = FALSE)
sqrt(dim(webtrain_a)[1])
setwd("~/Documents/GitHub/fall2017-project4-fall2017-proj4-grp8/lib")
webtrain_a = read.csv("../output/webtrain_a.csv", header = FALSE)
sqrt(dim(webtrain_a)[1])
mode(webtrain_a)
webtrain_a_matrix = as.matrix(webtrain_a, nrow = 4151, ncol = 4151)
View(webtrain_a_matrix)
dim(webtrain_a_matrix)
webtrain_a_matrix = as.matrix(webtrain_a)
dim(webtrain_a_matrix)
webtrain_a_matrix[1,]
webtrain_a_matrix[2,]
webtrain_a_matrix[5,]
a <- seq(1, 50)
mode(a)
webtrain_a_matrix = as.numeric(webtrain_a)
webtrain_a_matrix = as.numeric(unlist(webtrain_a))
webtrain_a = read.csv("../output/webtrain_a.csv", header = FALSE)
sqrt(dim(webtrain_a)[1])
mode(webtrain_a)
webtrain_a_matrix = as.numeric(unlist(webtrain_a))
webtrain_a_matrix = matrix(webtrain_a_matrix, nrow = 4151, ncol = 4151)
dim(webtrain_a_matrix)
head(webtrain_a_matrix)
webtrain_a_matrix = as.numeric(unlist(webtrain_a))
webtrain_a_matrix[1]
webtrain_a_matrix = matrix(webtrain_a_matrix, nrow = 4151, ncol = 4151)
webtrain_a_matrix[1,1]
webtrain_a_matrix[1,2]
webtrain_a_matrix[1,4151]
webtrain_a_matrix[4151,4151]
View(webtrain_a_matrix)
View(webtrain_a_matrix)
mean(webtrain_a_matrix)
mean(webtrain_a_matrix)
sd(webtrain_a_matrix)
mean(webtrain_a)
webtrain_a = read.csv("../output/webtrain_a.csv", header = FALSE)
mean(webtrain_a)
mean(unlist(webtrain_a))
webtrain_a = unlist(webtrain_a)
sqrt(dim(webtrain_a)) # = 4151
sqrt(length(webtrain_a)) # = 4151
mean(webtrain_a)
sd(webtrain_a)
n = 5
webtrain_a_n_5 = webtrain_a
n = 5
for (i in 1:length(webtrain_a)){
if (i >= n){
webtrain_a_n_5[i] = 1
}
else{
webtrain_a_n_5[i] = webtrain_a_n_5[i]/5
}
}
webtrain_a_matrix = as.numeric(webtrain_a_n_5)
dim(webtrain_a_matrix)
length(webtrain_a_matrix)
webtrain_a_matrix_5 = as.numeric(webtrain_a_n_5)
webtrain_a_matrix_5 = matrix(webtrain_a_matrix, nrow = 4151, ncol = 4151)
dim(webtrain_a_matrix_5)
?save
save(webtrain_a_matrix_5,"../output/webtrain_significance_weighting_n=5")
save(webtrain_a_matrix_5,file = "../output/webtrain_significance_weighting_n=5.Rdata")
webtrain_a_n_5 = webtrain_a
n = 5
for (i in 1:length(webtrain_a)){
if (i >= n){
webtrain_a_n_5[i] = 1
}
else{
webtrain_a_n_5[i] = webtrain_a_n_5[i]/5
}
}
webtrain_a_matrix_5 = as.numeric(webtrain_a_n_5)
webtrain_a_matrix_5 = matrix(webtrain_a_matrix_5, nrow = 4151, ncol = 4151)
save(webtrain_a_matrix_5,file = "../output/webtrain_significance_weighting_n=5.Rdata")
View(webtrain_a_matrix_5)
which(webtrain_a_n_5 == 1)
webtrain_a_n_5 = webtrain_a
t
webtrain_a = unlist(webtrain_a)
webtrain_a = read.csv("../output/webtrain_a.csv", header = FALSE)
webtrain_a = unlist(webtrain_a)
sqrt(length(webtrain_a)) # = 4151
mean(webtrain_a)
sd(webtrain_a)
print(mean(webtrain_a),sd(webtrain_a))
print(sd(webtrain_a))
print(mean(webtrain_a))
print(sd(webtrain_a))
webtrain_a_n_5 = webtrain_a
n = 5
for (i in 1:length(webtrain_a)){
if (i >= n){
webtrain_a_n_5[i] = 1
}
else{
webtrain_a_n_5[i] = webtrain_a_n_5[i]/5
}
}
webtrain_a_matrix_5 = as.numeric(webtrain_a_n_5)
webtrain_a_matrix_5 = matrix(webtrain_a_matrix_5, nrow = 4151, ncol = 4151)
save(webtrain_a_matrix_5,file = "../output/webtrain_significance_weighting_n=5.Rdata")
sum(webtrain_a_n_5 == 1)
sum(webtrain_a_n_5 == 1)-i
i - sum(webtrain_a_n_5 == 1)
webtrain_a_n_8 = webtrain_a
n = 8
for (i in 1:length(webtrain_a)){
if (i >= n){
webtrain_a_n_8[i] = 1
}
else{
webtrain_a_n_8[i] = webtrain_a_n_5[i]/8
}
}
webtrain_a_matrix_8 = as.numeric(webtrain_a_n_8)
webtrain_a_matrix_8 = matrix(webtrain_a_matrix_8, nrow = 4151, ncol = 4151)
save(webtrain_a_matrix_5,file = "../output/webtrain_significance_weighting_n=5.Rdata")
save(webtrain_a_matrix_5,file = "../output/webtrain_significance_weighting_n=8.Rdata")
save(webtrain_a_matrix_5,file = "../output/webtrain_significance_weighting_n=5.Rdata")
save(webtrain_a_matrix_8,file = "../output/webtrain_significance_weighting_n=8.Rdata")
i - sum(webtrain_a_n_5 == 1)
i - sum(webtrain_a_n_8 == 1)
webtrain_a_n_10 = webtrain_a
n = 10
for (i in 1:length(webtrain_a)){
if (i >= n){
webtrain_a_n_10[i] = 1
}
else{
webtrain_a_n_10[i] = webtrain_a_n_10[i]/10
}
}
webtrain_a = read.csv("../output/webtrain_a.csv", header = FALSE)
webtrain_a = unlist(webtrain_a)
sqrt(length(webtrain_a)) # = 4151
print(mean(webtrain_a))
print(sd(webtrain_a))
webtrain_a_n_5 = webtrain_a
n = 5
for (i in 1:length(webtrain_a)){
if (webtrain[i] >= n){
webtrain_a_n_5[i] = 1
}
else{
webtrain_a_n_5[i] = webtrain_a_n_5[i]/5
}
}
for (i in 1:length(webtrain_a)){
if (webtrain_a[i] >= n){
webtrain_a_n_5[i] = 1
}
else{
webtrain_a_n_5[i] = webtrain_a_n_5[i]/5
}
}
webtrain_a_matrix_5 = as.numeric(webtrain_a_n_5)
webtrain_a_matrix_5 = matrix(webtrain_a_matrix_5, nrow = 4151, ncol = 4151)
save(webtrain_a_matrix_5,file = "../output/webtrain_significance_weighting_n=5.Rdata")
i - sum(webtrain_a_n_5 == 1)
webtrain_a_n_10 = webtrain_a
n = 10
for (i in 1:length(webtrain_a)){
if (webtrain_a[i] >= n){
webtrain_a_n_10[i] = 1
}
else{
webtrain_a_n_10[i] = webtrain_a_n_10[i]/10
}
}
webtrain_a_matrix_10 = as.numeric(webtrain_a_n_10)
webtrain_a_matrix_10 = matrix(webtrain_a_matrix, nrow = 4151, ncol = 4151)
save(webtrain_a_matrix_10,file = "../output/webtrain_significance_weighting_n=10.Rdata")
webtrain_a_n_8 = webtrain_a
n = 8
for (i in 1:length(webtrain_a)){
if (i >= n){
webtrain_a_n_8[i] = 1
}
else{
webtrain_a_n_8[i] = webtrain_a_n_5[i]/8
}
}
webtrain_a_n_8 = webtrain_a
n = 8
for (i in 1:length(webtrain_a)){
if (webtrain_a[i] >= n){
webtrain_a_n_8[i] = 1
}
else{
webtrain_a_n_8[i] = webtrain_a_n_5[i]/8
}
}
webtrain_a_matrix_8 = as.numeric(webtrain_a_n_8)
webtrain_a_matrix_8 = matrix(webtrain_a_matrix_8, nrow = 4151, ncol = 4151)
save(webtrain_a_matrix_8,file = "../output/webtrain_significance_weighting_n=8.Rdata")
i - sum(webtrain_a_n_8 == 1)
webtrain_a_n_10 = webtrain_a
n = 10
for (i in 1:length(webtrain_a)){
if (webtrain_a[i] >= n){
webtrain_a_n_10[i] = 1
}
else{
webtrain_a_n_10[i] = webtrain_a_n_10[i]/10
}
}
webtrain_a_matrix_10 = as.numeric(webtrain_a_n_10)
webtrain_a_matrix_10 = matrix(webtrain_a_matrix, nrow = 4151, ncol = 4151)
webtrain_a_matrix_10 = matrix(webtrain_a_matrix_10, nrow = 4151, ncol = 4151)
save(webtrain_a_matrix_10,file = "../output/webtrain_significance_weighting_n=10.Rdata")
i - sum(webtrain_a_n_10 == 1)
a1 = i - sum(webtrain_a_n_5 == 1)
a2 = i - sum(webtrain_a_n_8 == 1)
a3 = i - sum(webtrain_a_n_10 == 1)
webtrain_a_n_9 = webtrain_a
n = 9
for (i in 1:length(webtrain_a)){
if (webtrain_a[i] >= n){
webtrain_a_n_9[i] = 1
}
else{
webtrain_a_n_9[i] = webtrain_a_n_9[i]/9
}
}
webtrain_a_matrix_9 = as.numeric(webtrain_a_n_9)
webtrain_a_matrix_9 = matrix(webtrain_a_matrix_9, nrow = 4151, ncol = 4151)
save(webtrain_a_matrix_9,file = "../output/webtrain_significance_weighting_n=9.Rdata")
a1 = i - sum(webtrain_a_n_5 == 1)
a3 = i - sum(webtrain_a_n_9 == 1)
a4 = i - sum(webtrain_a_n_10 == 1)
